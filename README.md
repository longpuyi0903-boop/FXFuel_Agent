# 外汇周报 AI Agent

一键生成专业外汇分析报告，**数据准确、拒绝幻觉**。

## ✨ 核心特性

| 特性 | 说明 |
|------|------|
| 📊 **数据准确** | 所有数据来自官方/权威来源（外管局、金管局、FRED） |
| 🚫 **拒绝幻觉** | AI 只使用采集到的数据，禁止编造 |
| 💬 **追问一致** | 追问时保持与报告一致的数据口径 |
| 🆓 **完全免费** | 核心数据源全部免费（AKShare + FRED） |
| 🇨🇳 **国内友好** | 主要使用 AKShare，国内服务器访问稳定 |

## 🏗️ 架构设计

```
┌─────────────────────────────────────────────────────────────┐
│                      数据采集层                              │
│  AKShare (免费) + FRED (免费) + 金管局网页 (免费)            │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                   结构化数据存储                             │
│  JSON 格式，包含所有数据点及来源追踪                          │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                   严格约束的 Prompt                          │
│  禁止添加数据外的内容，所有数字必须与来源一致                  │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                   LLM 生成报告                               │
│  DeepSeek API (低温度，减少创造性)                           │
└─────────────────────────────────────────────────────────────┘
```

## 📦 数据覆盖

### 人民币数据
- USD/CNY 中间价（外管局官方）
- USD/CNH 离岸即期汇率
- 本周中间价区间（高/低）
- 在岸-离岸价差

### 港元数据
- USD/HKD 即期汇率
- 联系汇率区间位置（7.75-7.85）
- HIBOR 各期限利率（金管局）
- 港美利差

### 全球市场
- 美元指数 (DXY)
- 10年期美债收益率 (FRED)
- VIX 恐慌指数 (FRED)
- EUR/USD, USD/JPY

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置 API Key

```bash
cp .env.example .env
# 编辑 .env 文件，填入你的 API Key
```

**必需的 API Key:**
- `DEEPSEEK_API_KEY`: [获取地址](https://platform.deepseek.com/)

**推荐的 API Key:**
- `FRED_API_KEY`: [免费注册](https://fred.stlouisfed.org/docs/api/api_key.html)

### 3. 运行应用

```bash
streamlit run streamlit_app.py
```

## 📁 项目结构

```
fx_weekly_report/
├── config.py              # 配置文件
├── data_retriever.py      # 数据采集模块（核心）
├── prompt_templates.py    # Prompt 模板（防幻觉）
├── report_generator.py    # 报告生成器
├── streamlit_app.py       # Streamlit 主应用
├── requirements.txt       # 依赖
├── .env.example           # 环境变量示例
└── ARCHITECTURE.md        # 架构设计文档
```

## 🔧 核心改进点（相比原版）

### 1. 数据覆盖率 80%+
- 原版：3-4 个数据点
- 新版：20+ 个数据点

### 2. 严格 Prompt 约束
```
【核心规则】
1. 只能使用 <DATA> 中提供的数据
2. 禁止添加任何数据中没有的内容
3. 数字必须完全一致，不得四舍五入
4. 缺失数据明确说明"数据暂缺"
```

### 3. 对话 Context 保持
追问时传入：原始数据 + 已生成报告，保持一致性

### 4. 来源追踪
每个数据点都有明确来源，可追溯

## ⚠️ 注意事项

1. **AKShare 稳定性**: 数据源网站可能变化，需要定期更新 AKShare
2. **FRED 网络**: 国内访问可能需要配置代理
3. **数据延迟**: 中间价每日 9:50 更新，实时汇率延迟约 15 分钟

## 📝 License

MIT

## 🙏 致谢

- [AKShare](https://github.com/akfamily/akshare) - 开源金融数据接口
- [FRED](https://fred.stlouisfed.org/) - 美联储经济数据库
- [DeepSeek](https://www.deepseek.com/) - LLM API
